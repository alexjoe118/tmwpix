<!DOCTYPE html>
<html lang="zxx">

<head>
    <title>TMWPIX</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="TMWPIX" name="description" />
    <meta content="" name="keywords" />
    <meta content="" name="author" />
    <!-- CSS Files
    ================================================== -->
    <link id="bootstrap" href="css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="css/style.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" type="text/css" href="css/custom.css">
    <link id="font" href="fonts/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <div id="epg-container" class="">
        <header class="">
            <div class="p-3 d-flex align-items-center justify-content-between">
                <div class="back_btn_container d-flex justify-content-start">
                    <a href="#" onclick="window.history.back()" class="back_btn"><i
                            class="fa fa-3x fa-angle-left"></i></a>
                </div>
                <a href="#">
                    <img src="./img/logotmwpix.png" width="200" height="50" class="logo-img">
                </a>
            </div>
        </header>

        <div class="container reduced-margin mt-4">
            <div class="epg-container">
                <div class="d-flex flex-row epg-row">
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="today_title my-auto voicable-item">Channel</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">00:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">00:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">01:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">01:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">02:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">02:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">03:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">03:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">04:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">04:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">05:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">05:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">06:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">06:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">07:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">07:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">08:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">08:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">09:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">09:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">10:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">10:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">11:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">11:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">12:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">12:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">13:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">13:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">14:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">14:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">15:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">15:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">16:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">16:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">17:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">17:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">18:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">18:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">19:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">19:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">20:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">20:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">21:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">21:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">22:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">22:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">23:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">23:30</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">00:00</span></div>
                    <div class="contains-voicable-content col-1 epg-title d-flex justify-content-center"><span
                            class="my-auto voicable-item">00:30</span></div>

                </div>
                <!-- <div class="d-flex flex-row epg-row">
                  <div class="contains-voicable-content col-1 epg-heading d-flex justify-content-center"><span class="my-auto voicable-item">BBC One</span></div>
                  <div class="contains-voicable-content contains-item-with-description col-3 schedule-item d-flex"><span class="my-auto voicable-item epg-content-title"></span></div>
                  <div class="contains-voicable-content contains-item-with-description col-4 schedule-item d-flex"><span class="my-auto voicable-item epg-content-title"></span></div>
                  <div class="contains-voicable-content contains-item-with-description col-4 schedule-item d-flex"><span class="my-auto voicable-item epg-content-title"></span></div>
                  
              </div> -->

            </div>
        </div>
    </div>

    <!-- Javascript Files
    ================================================== -->
    <script src="js/plugins.js"></script>
    <script>
        const userToken = JSON.parse(window.localStorage.getItem('LOGGED_USR'));
        if (userToken == null) {
            window.location.href = "./login.html";
        }
        var TNow = {};
        var adjust_date = {};
        var link1 = `http://api.tmwpix.com/channels/currentTimeNow`;
        $.ajax({
            url: link1,
            type: 'GET',
            dataType: 'json',
            success: function (result) {
                if (result.hasOwnProperty('error')) {
                    alert(result['error']['message']);
                    window.location.href = "./index.html";
                } else {
                    const Year = result.date[0].Year;
                    const Month = result.date[0].Month;
                    const Day = result.date[0].Day;
                    const Hour = result.date[0].Hour;
                    const Minute = result.date[0].Minute;
                    const Second = result.date[0].Seconds;
                    // const TNow = hour * 60 + parseInt(minute, 10);
                    TNow = new Date(Year, Month - 1 < 0 ? 0 : Month - 1, Day, Hour, Minute, Second, 0);
                    adjust_date = new Date(Year, Month - 1 < 0 ? 0 : Month - 1, Day, 0, 0, 0, 0).getTime();
                    $(".today_title").html(`${TNow.getDate()}/${TNow.getMonth() + 1}/${TNow.getFullYear()}`);
                    console.log("currentTime:", adjust_date);
                }
            },
            error: function (xhr, status, error) {
                alert(`Error ${error}`);
            },

        });

        var EPGs = {};

        var link = `http://api.tmwpix.com/channels/returnepgminnow?user=${userToken.usr}&time=${userToken.time}&hash=${userToken.hash}&dtoken=${userToken.pass}&os=android&operator=1&tipo=${userToken.loginType}&usrtoken=${userToken.usrtoken}&hashtoken=${userToken.hashtoken}`;
        $.ajax({
            url: link,
            type: 'GET',
            dataType: 'json',
            success: function (result) {
                if (result.hasOwnProperty('error')) {
                    alert(result['error']['message']);
                } else {
                    console.log("epg", result);
                    EPGs = result;
                    if (EPGs.length < 1) {
                        window.location.href = "./index.html";
                    }
                    var html = "";
                    for (i = 0; i < EPGs.length; i++) {
                        html += "<div class='d-flex flex-row epg-row'>";
                        html += `<div class="contains-voicable-content col-1 epg-heading d-flex justify-content-center"><span class="my-auto voicable-item">${EPGs[i].nome}</span></div>`;
                        for (j = 0; j < EPGs[i].program.length; j++) {
                            html += `<div class="contains-voicable-content contains-item-with-description col-1 schedule-item d-flex" onclick="gotoChannel(${EPGs[i].id})"><span class="my-auto voicable-item epg-content-title">${EPGs[i].program[j].title}</span></div>`;
                        }
                        html += "</div>";
                    }
                    // console.log(html);
                    $(".epg-container").append(html);

                }
            },
            error: function (xhr, status, error) {
                alert(`Error ${error}`);
            },

        });
        function gotoChannel(channelId){
            window.location.href = `./channel.html?channelId=${channelId}`;
        }


    </script>
</body>

</html>